<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é“æ­‰äº¤äº’é¡µé¢</title>
    <!-- åŠ è½½ React, ReactDOM, Babel å’Œ Tailwind CSS -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- åŠ è½½ Lucide å›¾æ ‡åº“ -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @keyframes shake {

            0%,
            100% {
                transform: translate(0, 0);
            }

            25% {
                transform: translate(-5px, -5px);
            }

            50% {
                transform: translate(5px, 5px);
            }
        }

        .animate-shake {
            animation: shake 0.1s infinite;
        }

        @keyframes hit-float {
            0% {
                transform: scale(0.5);
                opacity: 1;
            }

            100% {
                transform: translateY(-120px) scale(1.2);
                opacity: 0;
            }
        }

        .hit-text {
            position: fixed;
            pointer-events: none;
            animation: hit-float 0.8s forwards;
            font-weight: bold;
            font-size: 2.5rem;
            color: #ff4d4d;
            text-shadow: 1px 1px 0 #fff;
            z-index: 100;
        }

        @keyframes flower-surge {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 0;
                top: 70%;
                left: 50%;
            }

            15% {
                opacity: 1;
            }

            100% {
                transform: translate(calc(-50% + var(--target-x)), calc(-50% + var(--target-y))) scale(18) rotate(1080deg);
                opacity: 0;
                top: 50%;
                left: 50%;
            }
        }

        .flower-burst {
            position: fixed;
            animation: flower-surge cubic-bezier(0.1, 0.8, 0.1, 1) forwards;
            z-index: 100;
        }

        body {
            -webkit-tap-highlight-color: transparent;
        }
    </style>
</head>

<body class="bg-[#FFF5F7]">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;

        function App() {
            const [currentPage, setCurrentPage] = useState('start');
            const [noButtonPosition, setNoButtonPosition] = useState({ x: 0, y: 0 });
            const [showHint, setShowHint] = useState(false);

            const [slapCount, setSlapCount] = useState(0);
            const [isImpact, setIsImpact] = useState(false);
            const [hits, setHits] = useState([]);
            const [userInputDays, setUserInputDays] = useState('');
            const [quizFeedback, setQuizFeedback] = useState('');
            const [calcStartDate, setCalcStartDate] = useState('2024-05-20');
            const [calcEndDate, setCalcEndDate] = useState(new Date().toISOString().split('T')[0]);
            const [calcResult, setCalcResult] = useState(null);
            const [forgiveScale, setForgiveScale] = useState(1);
            const [noForgiveScale, setNoForgiveScale] = useState(1);
            const [beggingLevel, setBeggingLevel] = useState(0);
            const [isFinalForgiven, setIsFinalForgiven] = useState(false);
            const [flowers, setFlowers] = useState([]);
            const [isFlowersExploding, setIsFlowersExploding] = useState(false);

            // ç”¨æˆ·æä¾›çš„å›¾ç‰‡é…ç½®
            const characterImg = "https://youke.xn--y7xa690gmna.cn/s1/2026/02/11/698bc4564959c.webp";
            const slapCharacterImg = "https://youke.xn--y7xa690gmna.cn/s1/2026/02/11/698bc457572b8.webp";

            const beggingTexts = [
                "æˆ‘æƒ³å’Œå®å®ä¸€ç›´åœ¨ä¸€èµ·ï¼Œå¥½ä¸å¥½ï¼ŸğŸ¥º",
                "è€å©†æ±‚æ±‚ä½ äº†ï¼ŒåŸè°…æˆ‘å¥½ä¸å¥½å˜›ğŸ¥º",
                "æˆ‘çŸ¥é“é”™äº†ï¼Œä»¥åå†ä¹Ÿä¸æ•¢ä¹±å‘è„¾æ°”äº†ğŸ˜­",
                "ä½ æ˜¯å…¨ä¸–ç•Œæœ€æ¸©æŸ”çš„å®å®ï¼ŒåŸè°…æˆ‘è¿™æ¬¡å§ğŸ™",
                "æ±‚æ±‚è€å©†å¼€æ©å•Šï¼Œæˆ‘çœŸçš„çŸ¥é“é”™äº†ğŸ˜­",
                "å®å®æœ€å¥½äº†ï¼Œä¸è¦ä¸ç†æˆ‘å¥½ä¸å¥½ğŸ¥º",
                "æ±‚æ±‚äº†ï¼æˆ‘ç»™è€å©†ç£•å¤´äº†ï¼ç °ç °ç °ï¼ğŸ™‡â€â™‚ï¸"
            ];

            const correctDays = useMemo(() => {
                const start = new Date('2024-05-20');
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                return Math.floor((today - start) / (1000 * 60 * 60 * 24));
            }, []);

            const moveButton = () => {
                const x = Math.random() * (window.innerWidth - 120);
                const y = Math.random() * (window.innerHeight - 60);
                setNoButtonPosition({ x: x - window.innerWidth / 2 + 60, y: y - window.innerHeight / 2 + 30 });
                setShowHint(true);
            };

            const handleSlap = (e) => {
                if (slapCount >= 3) return;
                const clientX = e.clientX || (e.touches && e.touches[0].clientX);
                const clientY = e.clientY || (e.touches && e.touches[0].clientY);
                setSlapCount(prev => prev + 1);
                setIsImpact(true);
                setTimeout(() => setIsImpact(false), 150);
                const newHit = { id: Date.now(), x: clientX, y: clientY, text: ['å•ªï¼', 'å“¼ï¼', 'æ‰“ï¼'][slapCount] };
                setHits(prev => [...prev, newHit]);
                setTimeout(() => setHits(prev => prev.filter(h => h.id !== newHit.id)), 800);
                if (slapCount === 2) setTimeout(() => setCurrentPage('opened'), 1000);
            };

            const triggerFlowerExplosion = () => {
                setIsFlowersExploding(true);
                const flowerEmojis = ['ğŸŒ¸', 'ğŸŒ¹', 'ğŸŒ·', 'ğŸŒ»', 'ğŸŒ¼', 'ğŸŒº', 'ğŸ’', 'ğŸ’', 'ğŸ’–'];
                setFlowers(Array.from({ length: 120 }).map((_, i) => ({
                    id: i,
                    emoji: flowerEmojis[Math.floor(Math.random() * flowerEmojis.length)],
                    angle: Math.random() * Math.PI * 2,
                    delay: Math.random() * 2,
                    duration: 1.2 + Math.random() * 1.5,
                    size: 20 + Math.random() * 30
                })));
            };

            const checkQuiz = () => {
                if (parseInt(userInputDays) === correctDays) {
                    setQuizFeedback('å®å®æ²¡é”™ï¼');
                } else {
                    setQuizFeedback('å®å®åœ¨ç®—ä¸€ä¸‹å‘¢ğŸ¥º');
                }
            };

            // è·¯ç”±æ¸²æŸ“é€»è¾‘
            if (currentPage === 'start') return (
                <div className="flex flex-col items-center justify-center min-h-screen p-4 text-center">
                    <div className="bg-white p-10 rounded-[40px] shadow-sm max-w-[400px] w-full border border-pink-50 flex flex-col items-center">
                        <img src={characterImg} className="mb-8 w-32 h-32 rounded-3xl border-4 border-pink-100 object-cover" alt="å°é¢" />
                        <h1 className="text-2xl font-bold text-gray-700 mb-10">ä¸å¥½æ„æ€è™«è™«å®å®ğŸ¥º</h1>
                        <div className="flex flex-col sm:flex-row gap-4 justify-center items-center w-full">
                            <button onClick={() => setCurrentPage('interact')} className="px-10 py-3 bg-[#E45A9B] text-white font-medium rounded-full shadow-md w-full sm:w-auto">æ‰“å¼€</button>
                            <button onMouseEnter={moveButton} onTouchStart={moveButton} style={{ transform: `translate(${noButtonPosition.x}px, ${noButtonPosition.y}px)`, transition: 'all 0.15s' }} className="px-10 py-3 bg-[#E9ECF0] text-[#606F7B] font-medium rounded-full w-full sm:w-auto">ä¸æ‰“å¼€</button>
                        </div>
                        <div className="h-6 mt-8 text-pink-400 text-sm">{showHint && "æ±‚ä½ æ‰“å¼€å˜›å°å®å®ğŸ¥º"}</div>
                    </div>
                </div>
            );

            if (currentPage === 'interact') return (
                <div className="flex flex-col items-center justify-center min-h-screen bg-[#FFF0F3] p-4 text-center">
                    <div className="mb-8">
                        <h2 className="text-xl font-bold text-pink-600 mb-1">è®©ä½ ç”Ÿæ°”äº†ï¼Œç”¨åŠ›æ‰“ï¼</h2>
                        <p className="text-pink-400 text-sm mb-4">ï¼ˆç‚¹å‡»å›¾ç‰‡å³ä»£è¡¨å‡»æ‰“ï¼‰</p>
                        <div className="flex gap-2 justify-center">
                            {[1, 2, 3].map(i => <div key={i} className={`w-4 h-4 rounded-full ${slapCount >= i ? 'bg-pink-500' : 'bg-white border'}`} />)}
                        </div>
                    </div>
                    <div onClick={handleSlap} className={isImpact ? 'animate-shake' : ''}>
                        <div className="w-72 h-72 rounded-[3rem] overflow-hidden border-8 border-white bg-white shadow-2xl relative cursor-crosshair">
                            <img src={slapCharacterImg} className="w-full h-full object-cover" alt="è¢«æ‰“" />
                        </div>
                    </div>
                    {hits.map(hit => <div key={hit.id} className="hit-text" style={{ left: hit.x - 40, top: hit.y - 40 }}>{hit.text}</div>)}
                </div>
            );

            if (currentPage === 'opened') return (
                <div className="flex flex-col items-center justify-center min-h-screen p-4 text-center">
                    <div className="max-w-[450px] w-full bg-white p-12 rounded-[50px] flex flex-col items-center shadow-sm">
                        <img src={characterImg} className="mb-8 w-44 h-44 rounded-full border-8 border-pink-50 object-cover" alt="å±•ç¤º" />
                        <h2 className="text-2xl font-bold text-gray-800 mb-8">è€å©†å®æ°”æ¶ˆäº†å¬æˆ‘è¯´å¥½ä¸å¥½ä¹ˆä¹ˆ</h2>
                        <button onClick={() => setCurrentPage('apology')} className="px-12 py-4 bg-[#E45A9B] text-white font-bold rounded-full shadow-lg">ä¸‹ä¸€é¡µ</button>
                    </div>
                </div>
            );

            if (currentPage === 'apology') return (
                <div className="flex flex-col items-center justify-center min-h-screen p-4 text-center">
                    <div className="max-w-[520px] w-full bg-white p-12 rounded-[50px] border border-pink-50 flex flex-col items-center shadow-sm">
                        <p className="text-2xl font-bold text-gray-700 mb-6">å¯¹ä¸èµ·æˆ‘çš„å®å®ğŸ˜­</p>
                        <p className="text-gray-600 text-lg mb-6 leading-relaxed">æ—©ä¸Šä¸åº”è¯¥å¯¹ä½ å‘èµ·åºŠæ°”ï¼Œåæ¥è¿™ä¹ˆæ¶æ¯’çš„éª‚ä½ ğŸ˜­<br />å¯¹ä¸èµ·å®å®æˆ‘æ²¡æœ‰æ§åˆ¶å¥½è‡ªå·±çš„æƒ…ç»ª</p>
                        <button onClick={() => setCurrentPage('memory')} className="px-12 py-4 bg-pink-400 text-white font-bold rounded-full">ä¸‹ä¸€é¡µ</button>
                    </div>
                </div>
            );

            if (currentPage === 'memory') return (
                <div className="flex flex-col items-center justify-center min-h-screen p-4 text-center">
                    <div className="max-w-[500px] w-full bg-white p-12 rounded-[50px] flex flex-col items-center shadow-sm">
                        <h2 className="text-3xl font-bold text-gray-800 mb-10">å®å®ä½ çŸ¥ä¸çŸ¥é“æˆ‘ä»¬å¤šå‰å®³</h2>
                        <button onClick={() => setCurrentPage('quiz')} className="px-12 py-4 bg-[#E45A9B] text-white font-bold rounded-full">ä¸‹ä¸€é¡µ</button>
                    </div>
                </div>
            );

            if (currentPage === 'quiz') return (
                <div className="flex flex-col items-center justify-center min-h-screen p-4 text-center">
                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-8 max-w-[950px] w-full">
                        <div className="bg-white p-10 rounded-[50px] shadow-sm flex flex-col items-center justify-center">
                            <h2 className="text-2xl font-bold text-gray-800 mb-10">æˆ‘ä»¬åœ¨ä¸€èµ·å¤šä¹…äº†ï¼Ÿ</h2>
                            <div className="relative w-full mb-6">
                                <input type="number" value={userInputDays} onChange={(e) => setUserInputDays(e.target.value)} className="w-full px-6 py-4 bg-gray-50 border-2 border-pink-100 rounded-2xl text-center text-xl font-bold" placeholder="è¾“å…¥å¤©æ•°" />
                                <span className="absolute right-6 top-1/2 -translate-y-1/2 text-gray-400">å¤©</span>
                            </div>
                            <button onClick={checkQuiz} className="w-full py-4 bg-[#E45A9B] text-white font-bold rounded-2xl active:scale-95 transition-all">æäº¤ç»“æœ</button>
                            <div className="mt-8 font-bold min-h-[3rem]">
                                {quizFeedback && <div className={`animate-bounce ${quizFeedback.includes('æ²¡é”™') ? 'text-green-500' : 'text-pink-400'}`}>{quizFeedback}</div>}
                                {quizFeedback === 'å®å®æ²¡é”™ï¼' && <button onClick={() => setCurrentPage('milestone')} className="text-pink-500 underline mt-2 block mx-auto">è¿›å…¥ä¸‹ä¸€é¡µ</button>}
                            </div>
                        </div>
                        <div className="bg-[#FFF9FA] p-8 rounded-[40px] border border-pink-100 text-left">
                            <h3 className="font-bold text-pink-500 mb-4 flex items-center gap-2">æ—¥æœŸè®¡ç®—å·¥å…·</h3>
                            <div className="space-y-4">
                                <div><label className="text-xs text-gray-400">èµ·å§‹æ—¥æœŸ</label><input type="date" value={calcStartDate} onChange={(e) => setCalcStartDate(e.target.value)} className="w-full p-2 border rounded" /></div>
                                <div><label className="text-xs text-gray-400">æˆªæ­¢æ—¥æœŸ</label><input type="date" value={calcEndDate} onChange={(e) => setCalcEndDate(e.target.value)} className="w-full p-2 border rounded" /></div>
                                <button onClick={() => setCalcResult(Math.floor((new Date(calcEndDate) - new Date(calcStartDate)) / 86400000))} className="w-full py-3 bg-white border border-pink-200 text-pink-500 font-bold rounded">è®¡ç®—å¤©æ•°</button>
                                {calcResult !== null && <div className="mt-4 text-3xl font-black text-pink-500 text-center animate-pulse">{calcResult} å¤©</div>}
                            </div>
                        </div>
                    </div>
                </div>
            );

            if (currentPage === 'milestone') return (
                <div className="flex flex-col items-center justify-center min-h-screen p-4 text-center">
                    <div className="max-w-[620px] w-full bg-white p-12 rounded-[60px] shadow-sm flex flex-col items-center">
                        <h2 className="text-3xl font-black text-[#E45A9B] mb-8">æˆ‘ä»¬åšæŒåœ¨ä¸€èµ·{correctDays}å¤©äº†</h2>
                        <div className="bg-pink-50 p-8 rounded-[2.5rem] italic mb-8 leading-relaxed">â€œå› ä¸ºå®å®çˆ±æˆ‘ å®å®å¯çˆ± æˆ‘å¾ˆçˆ±æˆ‘çš„å®å® æˆ‘èˆä¸å¾—ç¦»å¼€å®å®ğŸ˜­â€</div>
                        <div className="px-8 py-3 bg-yellow-400 text-white font-black rounded-full mb-12 shadow-lg">å·²ç»æ‰“è´¥äº†å…¨å›½ 99% çš„äººï¼</div>
                        <button onClick={() => setCurrentPage('future')} className="px-12 py-4 bg-[#E45A9B] text-white font-bold rounded-full shadow-md">æœ€åçš„è¯</button>
                    </div>
                </div>
            );

            if (currentPage === 'future') return (
                <div className="flex flex-col items-center justify-center min-h-screen p-4 text-center">
                    <div className="max-w-[600px] w-full bg-white p-12 rounded-[60px] shadow-sm min-h-[600px] flex flex-col justify-between py-16">
                        {!isFinalForgiven ? (
                            <>
                                <h2 className="text-2xl font-black text-gray-800 mb-6 px-4">{beggingTexts[beggingLevel]}</h2>
                                <p className="text-gray-600 text-lg mb-8 px-6 leading-loose">æˆ‘ä¸å¸Œæœ›å› ä¸ºæˆ‘ä¸€æ—¶çš„åå¿ƒæƒ…æ‰“ç ´äº†æ„Ÿæƒ…ã€‚ä»æ‡µæ‡‚åˆ°ç‰¢å›ºï¼Œè¿™{correctDays}å¤©æ˜¯æˆ‘ä»¬çš„è§è¯ã€‚æˆ‘æƒ³ä¸€ç›´èµ°ä¸‹å»ã€‚ğŸ¥º</p>
                                <div className="flex flex-col sm:flex-row gap-8 justify-center items-center">
                                    <button onClick={() => setIsFinalForgiven(true)} style={{ transform: `scale(${forgiveScale})` }} className="px-12 py-5 bg-[#E45A9B] text-white font-black rounded-full shadow-xl transition-all">åŸè°…ä½ äº†</button>
                                    <button onClick={() => { setNoForgiveScale(s => Math.max(s * 0.7, 0.2)); setForgiveScale(s => s + 0.4); setBeggingLevel(l => (l + 1) % beggingTexts.length); }} style={{ transform: `scale(${noForgiveScale})` }} className="px-10 py-3 bg-gray-200 text-gray-500 rounded-full transition-all">ä¸åŸè°…ï¼</button>
                                </div>
                            </>
                        ) : (
                            <div className="py-20 animate-bounce">
                                <h2 className="text-4xl font-black text-gray-800 mb-8">è´´è´´å®å®ï¼ğŸ’–</h2>
                                <button onClick={() => setCurrentPage('valentine')} className="px-12 py-4 bg-pink-100 text-pink-600 font-black rounded-full shadow-inner">ä¸‹ä¸€é¡µ</button>
                            </div>
                        )}
                    </div>
                </div>
            );

            if (currentPage === 'valentine') return (
                <div className="flex flex-col items-center justify-center min-h-screen p-4 text-center">
                    <div className="max-w-[620px] w-full bg-white p-12 rounded-[60px] shadow-sm flex flex-col items-center">
                        <h2 className="text-2xl md:text-3xl font-black text-gray-800 mb-8">ç¬¬äºŒä¸ªæƒ…äººèŠ‚å¿«åˆ°äº† âœ¨</h2>
                        <p className="text-xl text-gray-600 mb-12 leading-loose px-4">æŠŠè”ç³»æ–¹å¼æ‹‰å›æ¥ï¼Œå‘Šè¯‰æˆ‘æƒ³è¦ä»€ä¹ˆç¤¼ç‰©å¥½ä¸å¥½ï¼ŸğŸ¥º<br />æˆ‘æƒ³ç»™ä½ æœ€å¥½çš„å® çˆ±ã€‚</p>
                        <button onClick={() => setCurrentPage('flower_gift')} className="px-14 py-5 bg-[#E45A9B] text-white font-bold rounded-full shadow-lg">ä¸‹ä¸€é¡µ</button>
                    </div>
                </div>
            );

            if (currentPage === 'flower_gift') return (
                <div className="flex flex-col items-center justify-center min-h-screen p-4 text-center overflow-hidden relative">
                    {isFlowersExploding && flowers.map(f => (
                        <div key={f.id} className="flower-burst pointer-events-none" style={{
                            '--target-x': `${(Math.cos(f.angle) * 1800)}px`, '--target-y': `${(Math.sin(f.angle) * 1800)}px`,
                            animationDelay: `${f.delay}s`, animationDuration: `${f.duration}s`, fontSize: `${f.size}px`
                        }}> {f.emoji} </div>
                    ))}
                    <div className={`max-w-[520px] bg-white/90 p-14 rounded-[70px] shadow-sm transition-all relative z-10 ${isFlowersExploding ? 'scale-75 opacity-30' : 'scale-100'}`}>
                        <h2 className="text-4xl font-black text-gray-800 mb-6">æˆ‘ç»™è€å©†é€èŠ± ğŸ’</h2>
                        <p className="text-gray-500 mb-14 text-lg">è—ç€æˆ‘æ»¡æ»¡çš„å¿ƒæ„å’Œæœ€æ·±çš„æ­‰æ„ã€‚</p>
                        {!isFlowersExploding ? (
                            <button onClick={triggerFlowerExplosion} className="px-20 py-6 bg-red-500 text-white font-black text-3xl rounded-full shadow-2xl active:scale-95 transition-all">ç‚¹å‡»æ¥å—</button>
                        ) : (
                            <div className="flex flex-col items-center py-6">
                                <div className="text-7xl mb-10">ğŸŒ¸ğŸ’–ğŸŒ¸</div>
                                <p className="text-pink-600 font-black text-4xl mb-6">å®å®æˆ‘çˆ±ä½ ï¼</p>
                                <button onClick={() => { setCurrentPage('start'); setIsFlowersExploding(false); setForgiveScale(1); setNoForgiveScale(1); setIsFinalForgiven(false); }} className="text-gray-300 text-sm underline mt-4">é‡æ–°å¼€å§‹</button>
                            </div>
                        )}
                    </div>
                </div>
            );

            return null;
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>
